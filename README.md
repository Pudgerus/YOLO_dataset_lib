# YOLO Dataset Utility Functions Documentation

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å YOLO-–¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π, —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π

### `make_iamges_labels_paths(image_dst, labels_dst, type)`

–°–æ–∑–¥–∞—ë—Ç –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥–∏ `type` –≤–Ω—É—Ç—Ä–∏ –ø–∞–ø–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –º–µ—Ç–æ–∫.

---

## üìÑ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

### `ensure_dir(path)`

–°–æ–∑–¥–∞—ë—Ç –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

### `copy_file(src, dst)`

–ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª `src` –≤ `dst`, —Å–æ–∑–¥–∞–≤–∞—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞–ø–∫–∏.

### `move_file(src, dst)`

–ü–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ñ–∞–π–ª `src` –≤ `dst`, —Å–æ–∑–¥–∞–≤–∞—è –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–∞–ø–∫–∏.

### `delete_file(path)`

–£–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.

### `get_filename(path)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º.

### `get_file_stem(path)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∏–º—è —Ñ–∞–π–ª–∞ –±–µ–∑ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è.

---

## üñºÔ∏è –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### `list_images(dir_path)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ (`.jpg`, `.jpeg`, `.png`).

### `image_exists(path)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### `get_image_size(image_path)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —à–∏—Ä–∏–Ω—É –∏ –≤—ã—Å–æ—Ç—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.

### `resize_image(image_path, output_path, size=(640, 640))`

–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –Ω–æ–≤—ã–π –ø—É—Ç—å.

### `is_image_corrupted(path)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –æ—Ç–∫—Ä—ã—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é PIL –∏–ª–∏ OpenCV.

---

## üè∑Ô∏è –†–∞–±–æ—Ç–∞ —Å –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏ YOLO

### `list_labels(dir_path)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø—É—Ç–µ–π –∫ `.txt` –º–µ—Ç–∫–∞–º –≤ –ø–∞–ø–∫–µ.

### `get_image_label_pairs(img_dir, label_dir)`

–°–æ–∑–¥–∞—ë—Ç –ø–∞—Ä—ã (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –º–µ—Ç–∫–∞) –ø–æ —Å–æ–≤–ø–∞–¥–∞—é—â–∏–º –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤.

### `read_yolo_label(label_path)`

–°—á–∏—Ç—ã–≤–∞–µ—Ç YOLO-–º–µ—Ç–∫–∏: `[class_id, x_center, y_center, width, height]`.

### `write_yolo_label(label_path, labels)`

–ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç YOLO-–º–µ—Ç–∫–∏ –≤ —Ñ–∞–π–ª.

### `filter_labels_by_class(labels, keep_classes)`

–§–∏–ª—å—Ç—Ä—É–µ—Ç –º–µ—Ç–∫–∏, –æ—Å—Ç–∞–≤–ª—è—è —Ç–æ–ª—å–∫–æ —É–∫–∞–∑–∞–Ω–Ω—ã–µ –∫–ª–∞—Å—Å—ã.

### `reindex_classes(labels, mapping)`

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∫–ª–∞—Å—Å—ã –≤ –º–µ—Ç–∫–∞—Ö –ø–æ —Å–ª–æ–≤–∞—Ä—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.

### `is_yolo_label_file(filepath)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ª–∏ —Ñ–∞–π–ª —Ñ–æ—Ä–º–∞—Ç—É YOLO (—á–∏—Å–ª–∞, –ø—Ä–æ–±–µ–ª—ã, —Ç–æ—á–∫–∏).

### `is_label_empty(label_path)`

–ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—É—Å—Ç –ª–∏ —Ñ–∞–π–ª –º–µ—Ç–∫–∏ (–Ω–µ—Ç —Å—Ç—Ä–æ–∫ —Å —Å–æ–¥–µ—Ä–∂–∏–º—ã–º).

---

## üß™ –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞—Å–µ—Ç–∞–º–∏

### `shuffle_pairs(pairs)`

–ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–∞—Ä (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, –º–µ—Ç–∫–∞).

### `split_pairs(pairs, ratios)`

–î–µ–ª–∏—Ç –ø–∞—Ä—ã –Ω–∞ `train`, `val`, `test` –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –¥–æ–ª—è–º (tuple –∏–∑ 3 float).

### `split_list(lst, ratios=None)`

–†–∞–∑–±–∏–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –Ω–∞ —á–∞—Å—Ç–∏. –ï—Å–ª–∏ `ratios` –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ã, –¥–µ–ª–∏—Ç –Ω–∞ 3 —Ä–∞–≤–Ω—ã–µ —á–∞—Å—Ç–∏. –†–∞–±–æ—Ç–∞–µ—Ç —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º —á–∞—Å—Ç–µ–π.

### `count_files(dir_path, ext="")`

–°—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–ø–∫–µ (–ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—é, –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–æ).

### `count_classes(labels_dir)`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∏–∑ –≤—Å–µ—Ö `.txt` —Ñ–∞–π–ª–æ–≤.

### `random_seed(seed=42)`

–£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç seed –¥–ª—è `random` –∏ `numpy` –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏.

---
## –í—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### `split_dataset`<br/>

–ì–∏–±–∫–æ —Ä–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç (—Å–ø–∏—Å–æ–∫ –ø–∞—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ + –º–µ—Ç–∫–∞) –Ω–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º –¥–æ–ª—è–º –∏ –∏–º–µ–Ω–∞–º. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤—ã—Ö–æ–¥–Ω—ã—Ö –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª—å–∫–æ train/test, –∏–ª–∏ train/val/test, –∏–ª–∏ –¥–∞–∂–µ train/val/test/dev –∏ —Ç.–ø.).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
* `pairs` ‚Äî `(List[Tuple[str, str]]):` –°–ø–∏—Å–æ–∫ –∫–æ—Ä—Ç–µ–∂–µ–π (image_path, label_path), –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç.

* `ratios` ‚Äî `(Tuple[float, ...]):` –ö–æ—Ä—Ç–µ–∂ —Å –¥–æ–ª—è–º–∏ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤. –°—É–º–º–∞ –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–∞–≤–Ω–∞ 1.0.

* `names` ‚Äî (`Tuple[str, ...]`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `("train", "val", "test")`): –ò–º–µ–Ω–∞ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ ratios.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
`dict[str, List[Tuple[str, str]]]`: –°–ª–æ–≤–∞—Ä—å, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–ª—é—á ‚Äî –∏–º—è –ø–æ–¥–Ω–∞–±–æ—Ä–∞ ("train", "val" –∏ —Ç.–¥.), –∞ –∑–Ω–∞—á–µ–Ω–∏–µ ‚Äî —Å–ø–∏—Å–æ–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä `(image_path, label_path)`.

---

### `copy_dataset_subset`

–ö–æ–ø–∏—Ä—É–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—É—é —á–∞—Å—Ç—å –¥–∞—Ç–∞—Å–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `train`) –≤ —Ü–µ–ª–µ–≤—ã–µ –ø–∞–ø–∫–∏.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `pairs` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–∞—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏ –º–µ—Ç–æ–∫.
* `image_dst`, `label_dst` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.
* `subset` ‚Äî –ø–æ–¥–∫–∞—Ç–∞–ª–æ–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `'train'`).

---

### `move_dataset_subset`

–¢–æ –∂–µ, —á—Ç–æ `copy_dataset_subset`, –Ω–æ –ø–µ—Ä–µ–º–µ—â–∞–µ—Ç —Ñ–∞–π–ª—ã, –∞ –Ω–µ –∫–æ–ø–∏—Ä—É–µ—Ç.

---

### `reindex_dataset_classes`

–ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∏–Ω–¥–µ–∫—Å—ã –∫–ª–∞—Å—Å–æ–≤ –≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è—Ö –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—é.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `pairs` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–∞—Ä.
* `mapping` ‚Äî —Å–ª–æ–≤–∞—Ä—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è `{—Å—Ç–∞—Ä—ã–π: –Ω–æ–≤—ã–π}`.

---

### `generate_class_statistics`

–°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: —Å–∫–æ–ª—å–∫–æ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç—Å—è –≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è—Ö.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `label_dir` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å `.txt` –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
–°–ª–æ–≤–∞—Ä—å `{class_id: count}`.

---

### `split_labels_by_class`

–°–æ–∑–¥–∞—ë—Ç –ø–∞–ø–∫–∏ –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ –Ω–∏—Ö –∫–æ–ø–∏–∏ –º–µ—Ç–æ–∫, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π –∫–ª–∞—Å—Å.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `label_dir` ‚Äî –∏—Å—Ö–æ–¥–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –º–µ—Ç–∫–∞–º–∏.
* `output_dir` ‚Äî –∫–æ—Ä–Ω–µ–≤–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è.

---

### `backup_dataset`

–°–æ–∑–¥–∞—ë—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –¥–∞—Ç–∞—Å–µ—Ç–∞ (–≤—Å–µ—Ö –∏–ª–∏ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤).

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `source_dir` ‚Äî –ø—É—Ç—å –∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º—É –¥–∞—Ç–∞—Å–µ—Ç—É.
* `backup_dir` ‚Äî –ø—É—Ç—å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏.
* `extensions` ‚Äî —Ñ–∏–ª—å—Ç—Ä –ø–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `['.jpg', '.txt']`).

---

### `restore_dataset_backup`

–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –º–µ—Å—Ç–æ.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

* `backup_dir` ‚Äî –ø—É—Ç—å –∫ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏.
* `restore_dir` ‚Äî –ø—É—Ç—å, –∫—É–¥–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã.

## üìå –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

* `os`
* `shutil`
* `random`
* `numpy`
* `cv2`
* `PIL`
* `typing`
* `pathlib`
